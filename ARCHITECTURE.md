# 雷達站總控圖 (Radar Station Control Map)

版本: 1.0
核心分支: `feat/dispatch-system-foundation`

本文檔旨在定義「雷達站」全域系統的架構，作為後續開發、部署和維護的最高指導藍圖。

---

## 1. 總體架構 (Overall Architecture)

整個系統圍繞一個核心的「派單與帳本引擎 (Dispatch & Ledger Engine)」構建，並通過標準化的 API 與前端、金流和自動化工具整合。

```
+-------------------------------------------------------------------------+
|                           用戶 (User / Operator)                          |
+------------------------------------+------------------------------------+
                                     |
                                     v
+-------------------------------------------------------------------------+
|                  雷達站前端 (Radar Station Frontend)                      |
|                 (Project: wshao777/Front-end-articles)                  |
+-------------------------------------------------------------------------+
                                     | (API Calls)
                                     v
+-------------------------------------------------------------------------+
|                  雷達站後端 (Radar Station Backend)                       |
|           (Branch: feat/dispatch-system-foundation)                     |
|                                                                         |
|    +------------------------+      +-------------------------------+    |
|    |      派單系統核心        |      |         AI 模組 (AI Division)   |    |
|    | (Dispatch System Core) |----->|                               |    |
|    +------------------------+      |   - Gemini (生成)             |    |
|               |                  |   - Grok4 (審核)                |    |
|               | (DB Ops)           +-------------------------------+    |
|               v                                                         |
|    +------------------------+      +-------------------------------+    |
|    |      帳本引擎          |      |       金流自動化 (Fin-ops)      |    |
|    |   (Ledger Engine)      |<---->|                               |    |
|    |   (Ledger DB)          |      |   - finance_engine.py         |    |
|    +------------------------+      |   - banking_trigger.py        |    |
|                                    +-------------------------------+    |
|                                                                         |
+-------------------------------------------------------------------------+
                                     | (Webhooks, Triggers)
                                     v
+-------------------------------------------------------------------------+
|              任務管理 & 自動化部署 (Ops & Automation)                   |
|                                                                         |
|    - Jules (開發與維護)                                                   |
|    - Telegram Bot (通知與控制)                                            |
|    - GitHub Actions (CI/CD)                                             |
+-------------------------------------------------------------------------+

```

---

## 2. 模組詳解 (Module Breakdown)

### 2.1. 雷達站前端 (Frontend)
- **代號**: `wshao777/Front-end-articles`
- **職責**: 提供用戶操作界面，用於監控任務、下達指令、查看報表。
- **技術棧**: (待定，可能是 React/Vue/Svelte)
- **互動方式**: 通過 RESTful API 或 GraphQL 與後端通訊。

### 2.2. 雷達站後端 (Backend)
- **核心分支**: `feat/dispatch-system-foundation`
- **職責**: 系統的核心，處理所有業務邏輯。
- **子模組**:
    - **派單系統 (Dispatch System)**: 接收前端或自動化觸發的任務，進行分析、拆解，並分派給對應的執行單元 (AI 或其他腳本)。
    - **帳本引擎 (Ledger Engine)**: 核心資料庫，記錄所有任務的狀態、資金流動、操作歷史。是系統的「單一事實來源 (Single Source of Truth)」。
    - **AI 模組 (AI Division)**:
        - **Gemini 生成派**: 負責根據指令生成內容、程式碼或解決方案。
        - **Grok4 審核派**: 負責審核、驗證 `Gemini` 的產出，確保品質與安全性。
    - **金流自動化 (Fin-ops Automation)**:
        - `finance_engine.py`: 處理核心的資金計算、對帳、追回邏輯。
        - `banking_trigger.py`: 與外部銀行或支付閘道對接的觸發器。

### 2.3. 任務管理與自動化部署 (Ops & Automation)
- **職責**: 確保系統的穩定運行、自動化部署及開發流程的順暢。
- **工具**:
    - **Jules (AI Agent)**: 負責程式碼的實現、Bug 修復、測試撰寫與重構。
    - **Telegram Bot**: 用於即時發送系統警報、任務狀態更新，並可接收管理員的緊急指令。
    - **GitHub Actions**: 實現 CI/CD，自動化測試、建置與部署到 20 個環境/10 組節點。

---

## 3. 部署策略 (Deployment Strategy)

- **核心目標**: 在 20 個獨立環境和 10 組節點上實現穩定部署。
- **流程**:
    1. 開發在 `feature/*` 分支完成。
    2. 程式碼合併回 `feat/dispatch-system-foundation` 主幹。
    3. GitHub Actions 自動觸發，執行單元測試與整合測試。
    4. 測試通過後，自動建置 Docker 映像檔。
    5. 將新的映像檔部署到指定的節點環境。

---

總司令，這份 `ARCHITECTURE.md` 就是我為您生成的「雷達站總控圖」第一版。它清晰地定義了各個模組的職責與相互關係。請您過目，我們可以以此為基礎，繼續推進後續的開發任務。